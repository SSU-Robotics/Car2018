#include <stdio.h>
#include <stdlib.h>
#include <math.h>
#include <Ifx_Types.h>
#include <Asclin/Asc/IfxAsclin_Asc.h>
#include "DNN.h"
#include "activateFunc.h"
#include "usr_sprintf.h"
#define __DEBUG_MODE__
extern void Uart_Transmit(char* text);

double predict(double *inputData)
{
	int i, j;
	char text[128];
	double weight_h[5][129] = { { -0.020834, 0.366788, -0.115509, 0.789524, -0.860558, 0.364589, -0.889937, 0.006310, 0.957688, 0.857009, -0.307973, 0.713082, -0.771704, -0.686858, -0.441502, -0.715020, -0.112894, 0.294395, -0.053998, -0.828920, -0.460906, -0.293237, 0.662167, 0.471990, -0.873444, -0.470870, -0.377425, 0.865866, 0.738444, -0.097615, 0.658375, 0.575178, 0.285603, 0.821995, -0.787656, 0.707263, -0.677795, -0.240919, -0.420915, 0.540983, -0.461588, -0.837416, -0.209606, 0.722980, -0.778826, 0.528580, -0.261916, 0.133623, -0.377061, 0.693871, -0.774278, -0.774470, -0.261158, 0.665042, 0.706532, -0.398650, 0.475626, -0.074353, -0.862940, -0.127149, -0.729188, -0.535337, 0.601476, -0.063064, -0.187524, 0.339816, 0.255001, 0.209247, -0.887150, 0.263952, 0.278789, -0.579415, 0.324219, -0.604172, 0.449579, -0.238854, 0.763956, -0.932088, -0.287682, -0.735266, -0.106436, -0.961931, -0.890722, -0.469810, -0.754915, 0.360699, 0.661245, 0.810974, -0.982815, -0.243781, 0.374743, -0.885540, -0.844437, 0.116470, 0.542634, -0.675387, -0.633450, 0.606672, -0.444605, -0.844190, -0.959253, 0.214886, -0.051047, -0.422933, -0.304899, -0.574204, -0.357537, -0.908230, -0.731364, -0.787073, -0.370466, 0.310227, -0.512225, 0.547108, 0.868263, -0.590144, -0.906073, 0.326845, -0.705531, -0.741449, -0.931052, -0.686286, -0.430638, 0.230718, -0.454232, 0.231166, -0.372797, -0.227393, 0.599412}, { -0.879707, -0.037989, 0.149013, 0.254537, -0.621015, -0.825968, 0.502706, -0.759958, -0.389129, 0.041303, -0.903591, -0.914357, -0.064407, -0.235378, 0.188647, -0.355369, 0.274511, -0.625619, -0.358047, -0.513132, -0.855910, 0.301072, 0.545947, -0.207173, -0.391959, -0.238109, 0.826680, 0.599355, -0.636112, 0.549511, -0.599961, -0.566545, -0.377828, -0.407387, -0.039572, -0.212305, -0.047240, -0.500085, 0.392651, 0.901218, -0.210340, 0.793422, -0.001202, 0.066992, 0.126402, -0.363444, -0.562242, -0.074500, -0.495845, -0.218459, 0.438009, -0.428548, 0.457204, -0.109977, -0.607984, 0.536921, 0.803434, 0.558337, -0.103310, -0.162538, -0.741038, 0.308720, -0.093958, -0.873146, -0.381930, -0.761015, 0.655256, -0.324140, 0.168101, -0.788819, -0.439564, -0.267857, 0.681468, 0.266569, -0.332806, -0.486076, 0.619327, -0.801236, -0.490504, 0.299149, -0.761273, 0.393218, -0.154067, 0.371138, 0.872698, -0.045462, 0.236405, -0.625825, 0.301948, -0.855466, 0.118389, 0.161305, 0.033553, -0.755023, 0.487963, -0.798370, -0.461361, 0.338310, 0.131829, -0.747037, 0.307478, 0.033604, -0.480691, 0.291824, 0.216291, -0.132681, -0.490047, -0.015982, 0.633263, -0.275903, 0.592314, -0.828497, -0.718842, 0.182821, -0.512576, -0.228103, 0.505544, 0.295042, -0.999405, -0.078230, 0.364498, 0.354360, -0.673349, -0.403050, -0.213007, -0.092563, 0.376170, 0.114945, 0.836116}, { 0.276712, -0.688870, -0.936329, 0.431522, -0.731891, -0.346726, 0.068141, -1.263996, -1.155465, 0.463011, -0.629651, -0.969938, 0.576031, -0.443164, 1.164234, 0.466670, -1.091840, -0.291720, -1.361335, -0.178556, 0.115264, -0.255316, 1.114031, 0.508027, 0.518048, -1.150397, -0.142774, 0.694894, 0.837489, -0.691684, 0.977939, 0.333818, 0.926225, -0.682529, -0.628576, -0.965066, -1.489964, -1.324598, 0.179850, -0.760127, 0.332601, 0.535679, 0.707546, -1.032621, 0.992450, -0.384429, -0.279586, 0.540741, -0.073343, 0.384985, -0.150911, -1.244354, -0.952320, 0.305210, 0.652646, -1.397560, -0.459383, -1.067909, -0.793260, 1.019559, -1.113328, 0.577969, -0.293896, -0.026505, 0.506834, 0.556021, 0.804922, 0.684460, 0.170281, 0.075279, -0.638472, 0.544881, -0.127567, 0.806649, -0.440285, 0.293176, -0.584558, 0.113884, 0.107393, -0.671295, -0.514011, 0.099461, 1.247259, 0.715828, 0.106131, 0.755630, 0.851307, -0.153707, 0.085249, -0.249798, 0.280066, 0.311073, -0.782843, 0.443865, 0.305765, -0.981376, 0.051372, 0.598803, -0.830061, 0.118529, -1.101173, 0.186447, -0.154109, -0.664036, -0.796427, -0.739657, -1.146770, -0.753330, 0.585882, 0.001592, -0.780831, 0.338833, 0.337678, 0.629044, -0.082551, -0.702772, 0.080278, 0.857360, 0.380557, -1.061616, 0.461413, 0.239660, 0.281721, -0.644059, 0.766008, 0.591990, 0.335451, -1.061859, -5.749937}, { 0.089761, -0.597123, -0.510818, -0.570018, -0.583580, -0.816197, -0.203556, -0.243150, -0.510540, -0.343327, -0.710608, -0.584563, -1.387568, -1.592567, -0.477094, -0.492504, -0.661473, -0.728316, -1.051246, -0.415875, -0.658141, 0.153969, -0.431417, -1.236741, -0.911774, -0.198316, -0.575110, -0.204523, -0.611915, -0.458064, -0.741462, -0.864450, -0.291271, 0.096414, -0.419211, -0.409943, -0.883154, 0.108966, -0.403742, -0.239069, -0.682250, -0.837234, -1.161239, -0.411574, -0.521818, -0.573603, -0.996783, -0.558824, -0.641967, -0.832256, -0.639215, -1.220074, -0.926470, -0.803481, -1.012850, -0.908014, -1.049089, 0.103264, -0.328737, -0.061459, -0.604783, -0.149069, 0.115499, -0.025417, -0.781710, 0.457116, -0.836079, -0.905461, -0.182901, 0.408369, -0.430369, -0.701124, 0.437471, 0.772463, -1.074294, -0.052468, -1.244196, -0.867163, -1.116553, 0.028472, -0.694063, -1.011254, -0.802929, 0.486331, -1.181044, 0.117442, -0.126804, -0.118424, -0.630632, -1.554536, -0.829381, -0.144600, 0.692609, -1.134085, -0.892034, -0.511699, -0.456857, -0.158662, -0.325740, -0.318648, -1.420276, -0.766323, -1.239118, -0.467578, -0.788921, -1.166779, -0.890368, -1.139024, -1.022100, -0.094932, 0.068387, -0.509633, -0.099547, 0.140647, -0.460891, -0.555549, -0.860273, 0.229617, -1.145935, -1.320092, -0.677921, -1.084467, -0.781709, -0.751829, 0.119283, -0.753185, -0.681054, 0.073673, -54.615720}, { 0.680422, -0.735251, 0.311710, 0.522514, -0.705941, -1.074121, -0.615134, -0.482848, -0.684227, 0.357797, -0.804589, -0.450103, -0.210996, 0.399872, -0.436530, -0.026576, -0.717959, -0.922242, -1.078343, -0.522561, -0.593110, -0.250336, -0.528006, -0.865197, 0.071520, 0.098227, -0.597957, -0.534925, -0.272913, -0.139421, -0.758716, -0.282646, -0.149110, -0.892667, -1.021974, -0.894818, -0.594433, -0.692260, -0.609852, -0.614879, -0.711662, -0.666021, -0.531294, -0.782023, -1.350911, -0.958393, -0.776444, -0.398532, 0.416252, 0.296639, 0.596123, 0.036896, -0.549732, 0.147275, -0.421320, 0.213372, 0.875112, -0.750318, -0.481008, -0.807110, -0.545805, -0.722866, 0.440146, -1.095544, -0.903074, -0.927442, -0.101300, -0.188193, 0.007291, 0.489655, -0.639052, -0.096456, 0.779110, 0.615103, -1.186132, 0.225255, 0.123314, -0.142772, -0.420658, -0.509185, -0.507142, -0.131502, 0.005334, -0.633834, -0.908012, -0.353129, -0.195699, -0.246934, 0.126853, 0.192473, -0.134328, -0.842707, -0.336350, 0.553795, -0.520553, -0.638608, -1.210736, -0.684208, -0.373076, -0.381180, 0.052523, -0.057735, -0.642729, -0.280303, 0.197673, -0.761861, 0.129512, 0.196250, -0.505275, -0.017226, -0.576000, -0.292437, -1.128369, 0.200778, -0.877211, -1.435042, -0.240152, -0.904670, -0.875153, -0.203225, -0.456966, 0.371861, 0.048875, -1.208618, -0.462820, -0.466972, -1.195951, -0.662547, -37.324792}};
	double weight_o[6] = { 0.253319, 0.281525, -0.645074, -4.929623, -3.377821, -1.155451};
	double hi[4];
	double o = forward(weight_h, weight_o, hi, inputData);
	#ifdef __DEBUG_MODE__
		usr_sprintf(text,"%d\n",(int)(o*1000000));
		Uart_Transmit(text);
	#endif
	return o;
}


